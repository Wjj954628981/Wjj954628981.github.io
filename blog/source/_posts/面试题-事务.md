---
title: 面试题-事务
date: 2020-02-26 01:40:06
tags: [面试]
---

事务是面试题中必考问题之一。

<!--more-->

# 事务
### 事务特性
事务特性分为四个：原子性（Atomicity）、一致性（Consistency）、隔离性（Isolation）、持续性（Durability），简称ACID。
- 原子性：事务是数据库逻辑工作单元，事务中包含的操作要么都执行成功，要么都执行失败。
- 一致性：事务执行的结果必须是从一个一致性状态转换为另一个一致性状态。
- 隔离性：一个事务的执行过程中不能影响到其他事务的执行，即一个事务内部操作及使用的数据对其他事务是隔离的，并发执行各个事务互不干扰。
- 持续性：一个事务一旦提交，它对数据库数据的改变是永久性的，后续操作不应该对其执行结果有任何影响。
### 事务隔离级别
事务隔离级别分为四种，从低到高依次分为：读未提交（Read Uncommited）、读已提交（Read Commited）、可重复读（Repeatable Read）、串形化（Serializable），可依次解决丢失更新、脏读、不可重复读、幻读等问题。
#### 隔离级别
- Read Uncommited：一个事务在执行过程中，既可以访问其他事务未提交的新插入的数据，又可以访问未提交的修改数据。如果一个事务已经开始写数据，则另外一个事务不允许同时进行写操作，但允许其他事务读此行数据。此隔离级别可防止丢失更新。
- Read Commited：一个事务在执行过程中，既可以访问其他事务成功提交的新插入的数据，又可以访问成功修改的数据。读取数据的事务允许其他事务继续访问该行数据，但是未提交的写事务将会禁止其他事务访问该行。此隔离级别可有效防止脏读。
- Repeatable Read：一个事务在执行过程中，可以访问其他事务成功提交的新插入的数据，但不可以访问成功修改的数据。读取数据的事务将会禁止写事务（但允许读事务），写事务则禁止任何其他事务。此隔离级别可有效防止不可重复读和脏读。
- Serilizable：提供严格的事务隔离。它要求事务序列化执行，事务只能一个接着一个地执行，不能并发执行。此隔离级别可有效防止脏读、不可重复读和幻读。但这个级别可能导致大量的超时现象和锁竞争，在实际应用中很少使用。
#### 事务引发问题
- 丢失更新：两个事务同时更新一行数据，后提交（或撤销）的事务将之前事务提交的数据覆盖了。
- 脏读：指一个事务读取到另一个事务未提交的数据。
- 不可重复度：指一个事务对同一行数据重复读取两次，但得到的结果不同。
- 幻读：指一个事务执行两次查询，但第二次查询的结果包含了第一次查询中未出现的数据。

|隔离级别\事务问题|脏读|不可重复度|幻读|
|-|-|-|-|
|Read Uncommited|√|√|√|
|Read Commited|X|√|√|
|Repeatable Read|X|X|√|
|Serilizable|X|X|X|

> MySQL默认隔离级别为Repeatable Read。